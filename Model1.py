# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2023-07-12 10:55:46
"""
import arcpy

addressString = "300 Queensferry Rd, Cary, North Carolina, 27511"
arcpy.env.overwriteOutput = True
arcpy.management.CreateTable(out_path="C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb", out_name="SingleAddress")
print("Table created")
arcpy.management.AddField(in_table="C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\SingleAddress", field_name="Address", field_type="TEXT")
print("Field created")
iCur = arcpy.da.InsertCursor("C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\SingleAddress", "Address")
row = [addressString]
iCur.insertRow(row)
del iCur

print("Value added")

def Model1():  # Model1

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    tracts = "tracts"
    Address = "C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\Address"
    ArcGIS_World_Geocoding_Service = "https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/ArcGIS World Geocoding Service"
    Police_Incidents = "Police Incidents"
    arcpy.env.overwriteOutput=True

    # Process: Geocode Addresses (Geocode Addresses) (geocoding)
    Address_GeocodeAddresses = "C:\\Users\\demo\\Downloads\\Downloads\\Default.gdb\\Address_GeocodeAddresses"
    arcpy.geocoding.GeocodeAddresses(in_table=Address, address_locator=ArcGIS_World_Geocoding_Service, in_address_fields="'Single Line Input' Address VISIBLE NONE", out_feature_class=Address_GeocodeAddresses, out_relationship_type="STATIC", country=["US"], location_type="ADDRESS_LOCATION", output_fields="ALL")

    # Process: Select Layer By Location (Select Layer By Location) (management)
    Layer_With_Selection, Output_Layer_Names, Count = arcpy.management.SelectLayerByLocation(in_layer=r"C:\Users\demo\Downloads\Downloads\Default.gdb\tracts_ExportFeatures", select_features=Address_GeocodeAddresses)

    # Process: Export Features (Export Features) (conversion)
    #PoliceIncident_ExportFeature1 = "C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1"
    #arcpy.env.overwriteOutput=True
    #arcpy.conversion.ExportFeatures(in_features=Police_Incidents, out_features=PoliceIncident_ExportFeature1, field_mapping="Crime_Category \"Crime Category\" true true false 100 Text 0 0,First,#,Police Incidents,Crime_Category,0,100;Crime_Type \"Crime Type\" true true false 100 Text 0 0,First,#,Police Incidents,Crime_Type,0,100;chrgcnt \"chrgcnt\" true true false 10 Text 0 0,First,#,Police Incidents,chrgcnt,0,10;UCR \"UCR Code\" true true false 10 Text 0 0,First,#,Police Incidents,UCR,0,10;District \"District\" true true false 10 Text 0 0,First,#,Police Incidents,District,0,10;Beat_Number \"Beat Number\" true true false 10 Text 0 0,First,#,Police Incidents,Beat_Number,0,10;Map_Reference \"Map Reference\" true true false 10 Text 0 0,First,#,Police Incidents,Map_Reference,0,10;Incident_Number \"Incident Number\" true true false 20 Text 0 0,First,#,Police Incidents,Incident_Number,0,20;Time_From \"Time From\" true true false 25 Text 0 0,First,#,Police Incidents,Time_From,0,25;Time_To \"Time To\" true true false 25 Text 0 0,First,#,Police Incidents,Time_To,0,25;Date_From \"Date From\" true true false 8 Date 0 0,First,#,Police Incidents,Date_From,-1,-1;Date_To \"Date To\" true true false 8 Date 0 0,First,#,Police Incidents,Date_To,-1,-1;CrimeDay \"Day Incident Occured\" true true false 0 Short 0 0,First,#,Police Incidents,CrimeDay,-1,-1;GeoCode \"Location\" true true false 100 Text 0 0,First,#,Police Incidents,GeoCode,0,100;Location_Category \"Location Category\" true true false 100 Text 0 0,First,#,Police Incidents,Location_Category,0,100;Lat \"Latitude\" true true false 0 Float 0 0,First,#,Police Incidents,Lat,-1,-1;Lon \"Longitude\" true true false 0 Float 0 0,First,#,Police Incidents,Lon,-1,-1;Neighborhd_ID \"Neighborhood ID\" true true false 10 Text 0 0,First,#,Police Incidents,Neighborhd_ID,0,10;Apartment_Complex \"Apartment Complex\" true true false 100 Text 0 0,First,#,Police Incidents,Apartment_Complex,0,100;Residential_Subdivision \"Residential Subdivision\" true true false 100 Text 0 0,First,#,Police Incidents,Residential_Subdivision,0,100;Subdivisn_ID \"Subdivision ID\" true true false 10 Text 0 0,First,#,Police Incidents,Subdivisn_ID,0,10;activity_date \"Activity Date\" true true false 50 Text 0 0,First,#,Police Incidents,activity_date,0,50;phxRecordStatus \"incident occurred when active in the Project Phoenix program\" true true false 255 Text 0 0,First,#,Police Incidents,phxRecordStatus,0,255;PhxCommunity \"Project Phoenix Community\" true true false 255 Text 0 0,First,#,Police Incidents,PhxCommunity,0,255;PhxStatus \"Project Phoenix Community Status\" true true false 25 Text 0 0,First,#,Police Incidents,PhxStatus,0,25;Record \"Record\" true true false 255 Text 0 0,First,#,Police Incidents,Record,0,255;OffenseCategory \"Offense Category\" true true false 100 Text 0 0,First,#,Police Incidents,OffenseCategory,0,100;timeframe \"Time Frame\" true true false 100 Text 0 0,First,#,Police Incidents,timeframe,0,100;domestic \"Domestic Call\" true true false 5 Text 0 0,First,#,Police Incidents,domestic,0,5;HourFrom \"HourFrom\" true true false 0 Short 0 0,First,#,Police Incidents,HourFrom,-1,-1;HourTo \"HourTo\" true true false 0 Short 0 0,First,#,Police Incidents,HourTo,-1,-1;ViolentProperty \"Violent Property\" true true false 20 Text 0 0,First,#,Police Incidents,ViolentProperty,0,20;dtmcrime \"dtmcrime\" true true false 0 Date 0 0,First,#,Police Incidents,dtmcrime,-1,-1")
    PoliceIncident_ExportFeature1 = r"C:\Users\demo\Downloads\Downloads\Default.gdb\PoliceIncident_ExportFeature"
    # Process: Calculate Field (Calculate Field) (management)
    PoliceIncident_ExportFeature = arcpy.management.CalculateField(in_table=PoliceIncident_ExportFeature1, field="Year", expression="getYear(!Date_From!)", expression_type="PYTHON3", code_block="""import time
def getYear(x):
    year = x.strftime('%Y')
    return year""")[0]

    # Process: Export Features (2) (Export Features) (conversion)
    PoliceIncident2022 = "C:\\Users\\demo\\Downloads\\Downloads\\Default.gdb\\PoliceIncident2022"
    arcpy.conversion.ExportFeatures(in_features=PoliceIncident_ExportFeature, out_features=PoliceIncident2022, where_clause="Year = '2022'", field_mapping="Crime_Category \"Crime Category\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Crime_Category,0,100;Crime_Type \"Crime Type\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Crime_Type,0,100;chrgcnt \"chrgcnt\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,chrgcnt,0,10;UCR \"UCR Code\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,UCR,0,10;District \"District\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,District,0,10;Beat_Number \"Beat Number\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Beat_Number,0,10;Map_Reference \"Map Reference\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Map_Reference,0,10;Incident_Number \"Incident Number\" true true false 20 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Incident_Number,0,20;Time_From \"Time From\" true true false 25 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Time_From,0,25;Time_To \"Time To\" true true false 25 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Time_To,0,25;Date_From \"Date From\" true true false 8 Date 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Date_From,-1,-1;Date_To \"Date To\" true true false 8 Date 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Date_To,-1,-1;CrimeDay \"Day Incident Occured\" true true false 2 Short 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,CrimeDay,-1,-1;GeoCode \"Location\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,GeoCode,0,100;Location_Category \"Location Category\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Location_Category,0,100;Lat \"Latitude\" true true false 4 Float 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Lat,-1,-1;Lon \"Longitude\" true true false 4 Float 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Lon,-1,-1;Neighborhd_ID \"Neighborhood ID\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Neighborhd_ID,0,10;Apartment_Complex \"Apartment Complex\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Apartment_Complex,0,100;Residential_Subdivision \"Residential Subdivision\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Residential_Subdivision,0,100;Subdivisn_ID \"Subdivision ID\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Subdivisn_ID,0,10;activity_date \"Activity Date\" true true false 50 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,activity_date,0,50;phxRecordStatus \"incident occurred when active in the Project Phoenix program\" true true false 255 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,phxRecordStatus,0,255;PhxCommunity \"Project Phoenix Community\" true true false 255 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,PhxCommunity,0,255;PhxStatus \"Project Phoenix Community Status\" true true false 25 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,PhxStatus,0,25;Record \"Record\" true true false 255 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Record,0,255;OffenseCategory \"Offense Category\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,OffenseCategory,0,100;timeframe \"Time Frame\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,timeframe,0,100;domestic \"Domestic Call\" true true false 5 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,domestic,0,5;HourFrom \"HourFrom\" true true false 2 Short 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,HourFrom,-1,-1;HourTo \"HourTo\" true true false 2 Short 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,HourTo,-1,-1;ViolentProperty \"Violent Property\" true true false 20 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,ViolentProperty,0,20;dtmcrime \"dtmcrime\" true true false 8 Date 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,dtmcrime,-1,-1;Year \"Year\" true true false 512 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Year,0,512")

    # Process: Spatial Join (Spatial Join) (analysis)
    tracts_SpatialJoin_2022 = "C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\tracts_SpatialJoin_2022"
    with arcpy.EnvManager(extent="DEFAULT"):
        arcpy.analysis.SpatialJoin(target_features=Layer_With_Selection, join_features=PoliceIncident2022, out_feature_class=tracts_SpatialJoin_2022, join_operation="JOIN_ONE_TO_ONE", join_type="KEEP_ALL", field_mapping="", match_option="INTERSECT")

    # Process: Summary Statistics (Summary Statistics) (analysis)
    tracts_SpatialJoi_Statistics2022 = "C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\tracts_SpatialJoi_Statistics2022"
    arcpy.analysis.Statistics(in_table=tracts_SpatialJoin_2022, out_table=tracts_SpatialJoi_Statistics2022, statistics_fields=[["Join_Count", "SUM"]], case_field=["Crime_Type"])

    # Process: Export Features (3) (Export Features) (conversion)
    PoliceIncident2021 = "C:\\Users\\demo\\Downloads\\Downloads\\Default.gdb\\PoliceIncident2021"
    arcpy.conversion.ExportFeatures(in_features=PoliceIncident_ExportFeature, out_features=PoliceIncident2021, where_clause="Year = '2021'", field_mapping="Crime_Category \"Crime Category\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Crime_Category,0,100;Crime_Type \"Crime Type\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Crime_Type,0,100;chrgcnt \"chrgcnt\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,chrgcnt,0,10;UCR \"UCR Code\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,UCR,0,10;District \"District\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,District,0,10;Beat_Number \"Beat Number\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Beat_Number,0,10;Map_Reference \"Map Reference\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Map_Reference,0,10;Incident_Number \"Incident Number\" true true false 20 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Incident_Number,0,20;Time_From \"Time From\" true true false 25 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Time_From,0,25;Time_To \"Time To\" true true false 25 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Time_To,0,25;Date_From \"Date From\" true true false 8 Date 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Date_From,-1,-1;Date_To \"Date To\" true true false 8 Date 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Date_To,-1,-1;CrimeDay \"Day Incident Occured\" true true false 2 Short 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,CrimeDay,-1,-1;GeoCode \"Location\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,GeoCode,0,100;Location_Category \"Location Category\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Location_Category,0,100;Lat \"Latitude\" true true false 4 Float 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Lat,-1,-1;Lon \"Longitude\" true true false 4 Float 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Lon,-1,-1;Neighborhd_ID \"Neighborhood ID\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Neighborhd_ID,0,10;Apartment_Complex \"Apartment Complex\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Apartment_Complex,0,100;Residential_Subdivision \"Residential Subdivision\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Residential_Subdivision,0,100;Subdivisn_ID \"Subdivision ID\" true true false 10 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Subdivisn_ID,0,10;activity_date \"Activity Date\" true true false 50 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,activity_date,0,50;phxRecordStatus \"incident occurred when active in the Project Phoenix program\" true true false 255 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,phxRecordStatus,0,255;PhxCommunity \"Project Phoenix Community\" true true false 255 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,PhxCommunity,0,255;PhxStatus \"Project Phoenix Community Status\" true true false 25 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,PhxStatus,0,25;Record \"Record\" true true false 255 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Record,0,255;OffenseCategory \"Offense Category\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,OffenseCategory,0,100;timeframe \"Time Frame\" true true false 100 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,timeframe,0,100;domestic \"Domestic Call\" true true false 5 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,domestic,0,5;HourFrom \"HourFrom\" true true false 2 Short 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,HourFrom,-1,-1;HourTo \"HourTo\" true true false 2 Short 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,HourTo,-1,-1;ViolentProperty \"Violent Property\" true true false 20 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,ViolentProperty,0,20;dtmcrime \"dtmcrime\" true true false 8 Date 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,dtmcrime,-1,-1;Year \"Year\" true true false 512 Text 0 0,First,#,C:\\Users\\demo\\Downloads\\Downloads\\IncidentsDemo.gdb\\PoliceIncident_ExportFeature1,Year,0,512")

    # Process: Spatial Join (2) (Spatial Join) (analysis)
    tracts_SpatialJoin_2021 = "C:\\Users\\demo\\Downloads\\Downloadstracts_SpatialJoin_2021.dbf"
    with arcpy.EnvManager(extent="DEFAULT"):
        arcpy.analysis.SpatialJoin(target_features=Layer_With_Selection, join_features=PoliceIncident2021, out_feature_class=tracts_SpatialJoin_2021, join_operation="JOIN_ONE_TO_ONE", join_type="KEEP_ALL", field_mapping="", match_option="INTERSECT")

    # Process: Summary Statistics (2) (Summary Statistics) (analysis)
    tracts_SpatialJoi_Statistics2021 = "C:\\Users\\demo\\Downloads\\Downloads\\tracts_SpatialJoi_Statistics2021.dbf"
    arcpy.analysis.Statistics(in_table=tracts_SpatialJoin_2021, out_table=tracts_SpatialJoi_Statistics2021, statistics_fields=[["Join_Count", "SUM"]], case_field=["Crime_Type"])

if __name__ == '__main__':
    # Global Environment settings
    with arcpy.EnvManager(scratchWorkspace="C:\\Users\\demo\\Downloads\\Downloads\\Default.gdb", workspace="C:\\Users\\demo\\Downloads\\Downloads\\Default.gdb", overwriteOutput=True):
        Model1()

print("All done")
